{% extends 'base.html' %}
{% load static %}

{% block title %}Acceso Denegado{% endblock %}

{% block content %}
<div class="container mt-5">
    <div class="row justify-content-center">
        <div class="col-md-8 col-lg-6">
            <div class="card shadow-lg border-danger">
                <div class="card-header bg-danger text-white text-center">
                    <i class="bi bi-shield-x" style="font-size: 3rem;"></i>
                    <h2 class="mt-3">üö´ Acceso Denegado</h2>
                </div>
                
                <div class="card-body text-center">
                    <h4 class="text-danger mb-4">{{ mensaje }}</h4>
                    
                    {% if permiso_requerido %}
                    <div class="alert alert-warning">
                        <i class="bi bi-info-circle"></i>
                        <strong>Permiso requerido:</strong><br>
                        <code>{{ permiso_requerido }}</code>
                    </div>
                    {% endif %}
                    
                    <hr class="my-4">
                    
                    <div class="mb-4">
                        <h5>¬øQu√© puedes hacer?</h5>
                        <ul class="list-unstyled text-start">
                            {% if not usuario_autenticado %}
                            <li class="mb-2">
                                <i class="bi bi-1-circle text-primary"></i>
                                <a href="{% url 'login' %}?next={{ request.path }}" class="btn btn-link">
                                    Iniciar sesi√≥n
                                </a> si a√∫n no lo has hecho
                            </li>
                            {% else %}
                            <li class="mb-2">
                                <i class="bi bi-1-circle text-primary"></i>
                                Contactar al administrador para solicitar permisos
                            </li>
                            <li class="mb-2">
                                <i class="bi bi-2-circle text-primary"></i>
                                Verificar que tienes el rol correcto asignado
                            </li>
                            {% if not es_superusuario %}
                            <li class="mb-2">
                                <i class="bi bi-3-circle text-primary"></i>
                                Volver a una p√°gina permitida
                            </li>
                            {% endif %}
                            {% endif %}
                        </ul>
                    </div>
                    
                    <div class="d-grid gap-2 d-md-flex justify-content-md-center">
                        <a href="javascript:history.back()" class="btn btn-outline-secondary">
                            <i class="bi bi-arrow-left"></i> Volver atr√°s
                        </a>
                        <a href="{% url 'inicio' %}" class="btn btn-primary">
                            <i class="bi bi-house"></i> Ir al inicio
                        </a>
                        {% if usuario_autenticado %}
                        
                        {% endif %}
                    </div>
                    
                    {% if es_superusuario %}
                    <div class="alert alert-info mt-4">
                        <i class="bi bi-tools"></i>
                        <strong>Modo Desarrollador:</strong><br>
                        Si ves este mensaje siendo superusuario, verifica:
                        <ul class="text-start mt-2 mb-0">
                            <li>Decorador en la vista tiene el permiso correcto</li>
                            <li>DEBUG est√° activado para bypass autom√°tico</li>
                            <li>El permiso existe en la base de datos</li>
                        </ul>
                    </div>
                    {% endif %}
                </div>
                
                <div class="card-footer text-muted text-center">
                    <small>
                        <i class="bi bi-clock"></i>
                        Si crees que esto es un error, contacta con soporte t√©cnico
                    </small>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
    .bi-shield-x {
        animation: shake 0.5s;
    }
    
    @keyframes shake {
        0%, 100% { transform: translateX(0); }
        25% { transform: translateX(-10px); }
        75% { transform: translateX(10px); }
    }
</style>
{% endblock %}