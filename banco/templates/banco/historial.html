{% extends "banco/base.html" %}
{% load banco_tags %}

{% block title %}Historial de Transferencias{% endblock %}

{% block extra_head %}
<style>
  .card-header {
    background: linear-gradient(135deg, var(--color-principal), var(--color-secundario));
    color: #fff;
    font-weight: 600;
    font-size: 1rem;
    padding: 1rem 1.25rem;
    border-bottom: none;
  }
</style>
{% endblock %}

{% block content %}
<div class="container py-4">
  <h2 class="mb-4 text-center">
    <i class="bi bi-clock-history"></i> Historial de Transferencias
  </h2>

  <!-- Enviadas -->
  <div class="card card-custom mb-4 shadow-sm">
    <div class="card-header bg-primary text-white">
      <i class="bi bi-arrow-up-circle-fill"></i> Transferencias Enviadas
    </div>
    <div class="card-body p-0">
      {% if enviadas %}
        <table class="table table-hover align-middle">
          <thead>
            <tr>
              <th>Fecha</th>
              <th>Destino</th>
              <th>Banco</th>
              <th>Monto</th>
              <th>Comprobante</th>
            </tr>
          </thead>
          <tbody>
            {% for tx in enviadas %}
              <tr>
                <td>{{ tx.fecha|date:"d/m/Y H:i" }}</td>
                <td>{{ tx.cuenta_destino.usuario.email }}</td>
                <td>{{ tx.cuenta_destino.entidad.nombre }}</td>
                <td class="text-danger fw-semibold">₲ {{ tx.monto }}</td>
                <td><code>{{ tx.comprobante }}</code></td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      {% else %}
        <div class="text-muted">No has enviado transferencias.</div>
      {% endif %}
    </div>
  </div>

  <!-- Recibidas -->
  <div class="card card-custom shadow-sm">
    <div class="card-header bg-success text-white">
      <i class="bi bi-arrow-down-circle-fill"></i> Transferencias Recibidas
    </div>
    <div class="card-body p-0">
      {% if recibidas %}
        <table class="table table-hover align-middle">
          <thead>
            <tr>
              <th>Fecha</th>
              <th>Origen</th>
              <th>Banco</th>
              <th>Monto</th>
              <th>Comprobante</th>
            </tr>
          </thead>
          <tbody>
            {% for tx in recibidas %}
              <tr>
                <td>{{ tx.fecha|date:"d/m/Y H:i" }}</td>
                <td>{{ tx.cuenta_origen.usuario.email }}</td>
                <td>{{ tx.cuenta_origen.entidad.nombre }}</td>
                <td class="text-success fw-semibold">₲ {{ tx.monto }}</td>
                <td><code>{{ tx.comprobante }}</code></td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      {% else %}
        <div class="text-muted">No has recibido transferencias.</div>
      {% endif %}
    </div>
  </div>

  <div class="text-center mt-4">
    <a href="{% url 'banco:dashboard' %}" class="btn btn-outline-secondary">
      <i class="bi bi-arrow-left-circle"></i> Volver al dashboard
    </a>
  </div>
</div>
{% endblock %}
