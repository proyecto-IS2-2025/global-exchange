{% extends "base.html" %}
{% load static %}

{% block content %}
<div class="container py-5">
  <h2 class="mb-5 text-center text-uppercase fw-bold text-primary">
    <i class="bi bi-people-fill me-2"></i> Selecciona un Cliente
  </h2>

  {% if clientes_asignados %}
    <div class="row justify-content-center g-4">
      {% for cliente in clientes_asignados %}
        <div class="col-md-4 col-sm-6">
          <form method="post" class="h-100">
            {% csrf_token %}
            <input type="hidden" name="cliente_id" value="{{ cliente.id }}">
            <div class="card h-100 border-0 rounded-4 shadow-sm 
              {% if cliente.id == cliente_activo_id %} border-primary border-3 {% endif %}
              transition-all hover-shadow">

              <!-- Encabezado -->
              <div class="card-header text-center fw-bold text-white rounded-top-4"
                   style="background: linear-gradient(135deg, #0d6efd, #66b2ff); box-shadow: inset 0 -1px 3px rgba(0,0,0,0.1);">
                <i class="bi bi-person-circle me-2 fs-4"></i> {{ cliente.nombre_completo }}
              </div>

              <!-- Contenido -->
              <div class="card-body text-center py-4">
                <p class="mb-2">
                  <strong>Cédula:</strong> {{ cliente.cedula }}
                </p>
                <p class="text-muted mb-1">
                  <i class="bi bi-envelope me-1 text-primary"></i> {{ cliente.email|default:"No registrado" }}
                </p>
                <p class="text-muted mb-1">
                  <i class="bi bi-telephone me-1 text-primary"></i> {{ cliente.telefono|default:"No disponible" }}
                </p>
                <p class="text-muted mb-1">
                  <i class="bi bi-geo-alt me-1 text-primary"></i> {{ cliente.direccion|default:"No registrada" }}
                </p>
                <p class="mt-3">
                  <span class="badge bg-info text-dark me-1">Segmento: {{ cliente.segmento.name }}</span>
                  <span class="badge bg-secondary">Tipo: {{ cliente.tipo_cliente|capfirst }}</span>
                </p>
              </div>

              <!-- Footer -->
              <div class="card-footer text-center bg-light border-top rounded-bottom-4 py-3">
                {% if cliente.id == cliente_activo_id %}
                  <span class="badge bg-success p-2 fs-6">
                    <i class="bi bi-check-circle me-1"></i> Cliente Activo
                  </span>
                {% else %}
                  <button type="submit" class="btn btn-outline-primary w-100 fw-semibold">
                    <i class="bi bi-arrow-right-circle me-1"></i> Usar este cliente
                  </button>
                {% endif %}
              </div>
            </div>
          </form>
        </div>
      {% endfor %}
    </div>
  {% else %}
    <div class="alert alert-warning text-center rounded-4 shadow-sm py-4 px-3">
      <i class="bi bi-exclamation-triangle-fill text-warning fs-4 me-2"></i>
      <p class="mb-2">No tienes clientes asignados. Se usará el segmento <strong>General</strong>.</p>
      <a href="{% url 'divisas:visualizador_tasas' %}" class="btn btn-outline-primary">
        <i class="bi bi-arrow-right-circle me-1"></i> Continuar
      </a>
    </div>
  {% endif %}
</div>
{% endblock %}
